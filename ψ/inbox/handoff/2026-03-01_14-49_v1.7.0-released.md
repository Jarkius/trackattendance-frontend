# Handoff: v1.7.0 Released — Voice Toggle & Employee Lookup

**Date**: 2026-03-01 14:49

## What We Did
- Implemented voice toggle (mute/unmute from header bar) and employee email/name lookup for forgot-badge users
- Fixed export column mismatch — unified format across station and dashboard exports
- Added `scan_source` column to Postgres (proper column, not jsonb meta)
- Merged PR #47, deployed API to Cloud Run, tagged v1.7.0, created GitHub release
- Cleaned up requirements.txt (removed 15 unused PoC packages)
- 268 tests passing

## Pending
- [ ] Fix proximity_manager NoneType crash on camera toggle off (`self._detector` becomes None mid-loop)
- [ ] Replace `explorer` with `open` for macOS export folder opening (line 53 in main.py logs)
- [ ] Consider showing scan_source on public mobile dashboard
- [ ] Add pre-push `tsc --noEmit` check to API repo to catch type errors locally

## Next Session
- [ ] Test v1.7.0 at actual event with real badge scans + manual lookups
- [ ] Verify scan_source appears correctly in dashboard Excel export after cloud sync
- [ ] Address proximity_manager crash if camera plugin is being used in production

## Key Files
- `attendance.py` — search_employee(), register_scan(scan_source=)
- `main.py` — 4 new pyqtSlots (voice toggle, search, manual scan)
- `database.py` — ScanRecord.scan_source, all fetch methods updated
- `sync.py` — scan_source sent as top-level field in sync payload
- `dashboard.py` — scan_source in export columns
- `web/script.js` — lookup overlay, search-first logic for non-numeric input
- `trackattendance-api/server.ts` — scan_source column, migration, insert, export
- `trackattendance-api/Postgres-schema.sql` — scan_source column definition
